!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=Object.assign({},t)}return r(e,[{key:"creator",value:function(e,t,n){n(Error("not implemented yet"))}},{key:"disposer",value:function(e,t){}},{key:"provider",get:function(){return this._provider||(this._provider=new scene.ReferenceMap(this.creator.bind(this),this.disposer.bind(this))),this._provider}}]),e}();t.default=o},function(e,t,n){"use strict";(function(r){function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(3)),u=o(n(0));e.exports={SceneIntegrator:i.default,SceneProvider:u.default},t.default=e.exports,"undefined"!=typeof window&&(window.SceneIntegrator=i.default,window.SceneProvider=u.default),void 0!==r&&(r.SceneIntegrator=i.default,r.SceneProvider=u.default)}).call(t,n(2))},function(e,t,n){"use strict";var r,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"===("undefined"==typeof window?"undefined":o(window))&&(r=window)}e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r(n(0)),u=r(n(4)),a={local:r(n(5)).default,"things-board-server":u.default},s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=Object.assign({},t);var n=t.fit,r=t.license,o=t.sceneProvider,u=void 0===o?"things-board-server":o;if("string"==typeof u){var a=e.getProvider(u);this.sceneProvider=a&&new a(t).provider}else{if(!(u instanceof i.default))return void console.error("Improper sceneProvider : ",u);this.sceneProvider=u}this.fitMode=n,scene&&scene.license(r)}return o(e,null,[{key:"instance",value:function(t){return this._instance||(this._instance=new e(t)),this._instance}},{key:"help",value:function(e){e||console.info("\n      ")}},{key:"registerProvider",value:function(e,t){a[e]?console.error("scene provider ("+e+") already registered."):a[e]=t}},{key:"getProvider",value:function(e){return a[e]}}]),o(e,[{key:"integrate",value:function(e){var t=e.target,n=e.sceneName,r=e.callback;this.show(n,t,r)}},{key:"fit",value:function(e,t){t.fit(e||this.fitMode)}},{key:"show",value:function(e,t,n){if(t&&(t=function(e){var t,n;if((t="string"==typeof e?document.getElementById(e):e).children&&t.children.length>0)for(var r in t.children){var o=t.children[r];if("scene-wrapper"==o.getAttribute("class")){n=o;break}}return n||(n=function(){var e=document.createElement("div");return e.style.width=e.style.height="100%",e.style.position="relative",e.setAttribute("class","scene-wrapper"),e}(),t.appendChild(n)),t=n}(t),this._releaseRef(t)),e){var r=this;this.sceneProvider.get(e,!0).then(function(e){e.target!==t?(t&&(e.target=t,r._bindAllEvents(e._container,r),r.fit(r.fitMode,e)),n&&n.call(null,e)):e.release()},function(e){n&&n.call(null,scene,e)})}}},{key:"_releaseRef",value:function(e){e&&e.scene&&(this._unbindAllEvents(e.scene._container,this),e.scene.release(),e.scene.target=null,e.scene.dispose(),delete e.scene)}},{key:"_bindAllEvents",value:function(e,t){for(var n in this.eventMap)if(this.eventMap.hasOwnProperty(n)){var r=this[this.eventMap[n]];e.on(n,r,t)}}},{key:"_unbindAllEvents",value:function(e,t){for(var n in this.eventMap)if(this.eventMap.hasOwnProperty(n)){var r=this[this.eventMap[n]];e.off(n,r,t)}}},{key:"fitMode",get:function(){return this._fitMode||"both"},set:function(e){this._fitMode=e}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),i=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"creator",value:function(e,t,n){var r=this.options,o=r.baseURL,i=void 0===o?"http://localhost/rest":o,u=(r.withCredentials,r.authorizationKey),a=r.authorizationType,s=void 0===a?"token":a,c=new XMLHttpRequest,f={"Content-Type":"application/json","Authorization-Type":s,"Authorization-Key":u};c.onloadend=function(r){var o=r.srcElement;if(200!==o.status)return 401==o.status?d.handleUnauthorized():d.openResponseError(o.response),void n("cannot fetch resource: "+e+", status: "+o.status);var u=r.target.response;u?d.provider.get(e).then(function(e){t(e),console.warn("Board fetched more than twice.",u.name)},function(r){try{var o=scene.create({model:JSON.parse(u.model),mode:0,refProvider:d.provider});o.app.baseUrl=i,t(o)}catch(r){n("cannot create board: "+e,r)}}):n("cannot fetch resource: "+e+", status: "+o.status)},c.ontimeout=function(){n("Timeout occured while fetching board: "+e)},c.withCredentials=!0,c.responseType="json",c.timeout=3e4,c.open("GET",i+"/scenes/"+e,!0);for(var l in f)c.setRequestHeader(l,f[l]);c.send();var d=this}}]),t}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),i=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"creator",value:function(e,t,n){var r=this.options.models[e];r?t(scene.create({model:r,mode:0,refProvider:self.provider})):n("cannot find model: "+e)}}]),t}();t.default=i}])});
